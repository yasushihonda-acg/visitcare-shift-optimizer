# Product Requirements Document (PRD) - 製品要件定義書

## 1. はじめに
- **製品名**: visitcare-shift-optimizer (Demo)
- **ターゲットユーザー**: 訪問介護事業所のサービス提供責任者（サ責）
- **課題**: スプレッドシートでのパズル作業が限界。移動時間ミスや資格不備、相性NGの見落としが多発

## 2. 機能要件 (Functional Requirements)

### 2.1 データ管理機能
- **Seedデータインポート**: CSV形式で利用者・スタッフ・制約条件を一括取り込み可能
- **マスタ編集**:
  - 利用者詳細: 「同一世帯ID（夫婦）」の設定、「NGスタッフ」「推奨スタッフ」の登録
  - スタッフ詳細: 「保有資格（身体介護可否）」、「移動手段（速度係数）」、「特定利用者への習熟度（同行中/独り立ち）」の設定

### 2.2 シフト自動生成機能 (AI Logic)
- **最適化実行**: 対象期間とチームを指定して実行
- **制約ロジック**:

#### ハード制約（必須）
- 資格不適合の禁止（身体介護に無資格者を当てない）
- 移動時間の確保（Google Maps実測値）
- 重複（ダブルブッキング）禁止
- NGスタッフの回避
- 夫婦・連続サービスの同一担当者固定

#### ソフト制約（努力目標）
- 移動時間の最小化
- 担当継続性（前回と同じ人）
- 空き時間の最小化（飛び石連休の回避）

### 2.3 シフト編集・可視化機能 (UI/UX)
- **ガントチャート**: スタッフ軸・時間軸でシフトをバー表示。移動時間を「隙間」として可視化
- **ドラッグ＆ドロップ**: AI作成後の手動調整機能
- **リアルタイムバリデーション**: 手動操作時にルール違反があれば即座に警告（赤枠・ツールチップ）
  - 警告内容例：「移動時間が5分不足」「資格なし（身体）」「同行期間中（単独訪問不可）」

## 3. 非機能要件 (Non-Functional Requirements)
- **パフォーマンス**: 最適化計算（スタッフ20名・利用者50名規模）を3分以内に完了
  - 計算時間が長引く場合は、UI上でプログレス表示
- **拡張性**: サービス数が1,000を超えた場合、エリア単位等で分割計算（パーティショニング）できる設計
- **外部連携準備**: 利用者・スタッフIDに「介ソルID」「カラカラID」等の外部キーを保持できるスキーマ設計
